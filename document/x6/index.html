<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>简介 | DataFan UI</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="所有的伟大，都源于一个勇敢的开始">
    
    <link rel="preload" href="/assets/css/0.styles.f997c9a8.css" as="style"><link rel="preload" href="/assets/js/app.4e651e34.js" as="script"><link rel="preload" href="/assets/js/2.9d5427ba.js" as="script"><link rel="preload" href="/assets/js/43.b6aa7346.js" as="script"><link rel="prefetch" href="/assets/js/10.d176b201.js"><link rel="prefetch" href="/assets/js/11.ab1e99d7.js"><link rel="prefetch" href="/assets/js/12.7c963246.js"><link rel="prefetch" href="/assets/js/13.203d9880.js"><link rel="prefetch" href="/assets/js/14.2b088ad9.js"><link rel="prefetch" href="/assets/js/15.d59429bc.js"><link rel="prefetch" href="/assets/js/16.a909a671.js"><link rel="prefetch" href="/assets/js/17.dee798da.js"><link rel="prefetch" href="/assets/js/18.3791e20b.js"><link rel="prefetch" href="/assets/js/19.81859b50.js"><link rel="prefetch" href="/assets/js/20.9e95e9a8.js"><link rel="prefetch" href="/assets/js/21.e83b9ce5.js"><link rel="prefetch" href="/assets/js/22.1347ddcd.js"><link rel="prefetch" href="/assets/js/23.2315df4d.js"><link rel="prefetch" href="/assets/js/24.b9ddbe72.js"><link rel="prefetch" href="/assets/js/25.2d31c25c.js"><link rel="prefetch" href="/assets/js/26.08cffa85.js"><link rel="prefetch" href="/assets/js/27.7f44fa64.js"><link rel="prefetch" href="/assets/js/28.8f90dcff.js"><link rel="prefetch" href="/assets/js/29.e64ad6c0.js"><link rel="prefetch" href="/assets/js/3.82b433ec.js"><link rel="prefetch" href="/assets/js/30.a52ff9b2.js"><link rel="prefetch" href="/assets/js/31.18ad0a2d.js"><link rel="prefetch" href="/assets/js/32.d7d5428d.js"><link rel="prefetch" href="/assets/js/33.1a2351c0.js"><link rel="prefetch" href="/assets/js/34.3a98dd55.js"><link rel="prefetch" href="/assets/js/35.6a79d14e.js"><link rel="prefetch" href="/assets/js/36.df82d509.js"><link rel="prefetch" href="/assets/js/37.862dc14b.js"><link rel="prefetch" href="/assets/js/38.10c1eda6.js"><link rel="prefetch" href="/assets/js/39.4ba4e9be.js"><link rel="prefetch" href="/assets/js/4.b6baf5a0.js"><link rel="prefetch" href="/assets/js/40.f141f5b7.js"><link rel="prefetch" href="/assets/js/41.227d6162.js"><link rel="prefetch" href="/assets/js/42.f3819493.js"><link rel="prefetch" href="/assets/js/5.a7b25c0b.js"><link rel="prefetch" href="/assets/js/6.a074fa35.js"><link rel="prefetch" href="/assets/js/7.98df8833.js"><link rel="prefetch" href="/assets/js/8.97939b82.js"><link rel="prefetch" href="/assets/js/9.1dc71ea9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f997c9a8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DataFan UI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/components/" class="nav-link">
  组件中心
</a></div><div class="nav-item"><a href="/document/" class="nav-link router-link-active">
  往期分享
</a></div><div class="nav-item"><a href="https://github.com/young-datafan/datafan-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/components/" class="nav-link">
  组件中心
</a></div><div class="nav-item"><a href="/document/" class="nav-link router-link-active">
  往期分享
</a></div><div class="nav-item"><a href="https://github.com/young-datafan/datafan-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/document/" aria-current="page" class="sidebar-link">开发手册</a></li><li><a href="/document/vue3/" class="sidebar-link">Vue3 新框架&amp;组件</a></li><li><a href="/document/pinia.html" class="sidebar-link">Pinia 新一代状态管理</a></li><li><a href="/document/TypeScript.html" class="sidebar-link">TypeScript</a></li><li><a href="/document/vue3-base.html" class="sidebar-link">Vue3 基础知识</a></li><li><a href="/document/x6/" aria-current="page" class="active sidebar-link">antv-X6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/x6/#简介" class="sidebar-link">简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/x6/#特性" class="sidebar-link">特性</a></li></ul></li><li class="sidebar-sub-header"><a href="/document/x6/#快速上手" class="sidebar-link">快速上手</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/x6/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/document/x6/#开始使用" class="sidebar-link">开始使用</a></li><li class="sidebar-sub-header"><a href="/document/x6/#画布" class="sidebar-link">画布</a></li><li class="sidebar-sub-header"><a href="/document/x6/#节点" class="sidebar-link">节点</a></li><li class="sidebar-sub-header"><a href="/document/x6/#边" class="sidebar-link">边</a></li></ul></li><li class="sidebar-sub-header"><a href="/document/x6/#基本教程" class="sidebar-link">基本教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/x6/#画布-graph-平移、缩放、居中" class="sidebar-link">画布 Graph 平移、缩放、居中</a></li><li class="sidebar-sub-header"><a href="/document/x6/#导出" class="sidebar-link">导出</a></li><li class="sidebar-sub-header"><a href="/document/x6/#销毁画布" class="sidebar-link">销毁画布</a></li></ul></li><li class="sidebar-sub-header"><a href="/document/x6/#项目中用到的方法" class="sidebar-link">项目中用到的方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/x6/#draggable" class="sidebar-link">draggable</a></li><li class="sidebar-sub-header"><a href="/document/x6/#连线验证-validateconnection" class="sidebar-link">连线验证（validateConnection）</a></li><li class="sidebar-sub-header"><a href="/document/x6/#事件系统" class="sidebar-link">事件系统</a></li><li class="sidebar-sub-header"><a href="/document/x6/#节点-边" class="sidebar-link">节点/边</a></li><li class="sidebar-sub-header"><a href="/document/x6/#cell" class="sidebar-link">Cell</a></li><li class="sidebar-sub-header"><a href="/document/x6/#model" class="sidebar-link">Model</a></li></ul></li></ul></li><li><a href="/document/Promise/" class="sidebar-link">Promise对象</a></li><li><a href="/document/Closure/" class="sidebar-link">闭包和Http缓存机制</a></li><li><a href="/document/vue3-unti-test.html" class="sidebar-link">Vue3 单元测试</a></li><li><a href="/document/js-design/" class="sidebar-link">设计模式</a></li><li><a href="/document/hooks/" class="sidebar-link">hook组件封装</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>X6 是 AntV 旗下的图编辑引擎，提供了一系列开箱即用的交互组件和简单易用的节点定制能力，方便我们快速搭建流程图、DAG 图、ER 图等图应用。</p> <h3 id="特性"><a href="#特性" class="header-anchor">#</a> 特性</h3> <ul><li>🌱　极易定制：支持使用 SVG/HTML/React/Vue 定制节点样式和交互；</li> <li>🚀　开箱即用：内置 10+ 图编辑配套扩展，如框选、对齐线、小地图等；</li> <li>🧲　数据驱动：基于 MVC 架构，用户更加专注于数据逻辑和业务逻辑；</li> <li>💯　事件驱动：可以监听图表内发生的任何事件。</li></ul> <h2 id="快速上手"><a href="#快速上手" class="header-anchor">#</a> 快速上手</h2> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <p>通过 npm 或 yarn 命令安装 X6。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># npm</span>
$ <span class="token function">npm</span> <span class="token function">install</span> @antv/x6 <span class="token parameter variable">--save</span>

<span class="token comment"># yarn</span>
$ <span class="token function">yarn</span> <span class="token function">add</span> @antv/x6
</code></pre></div><p>安装完成之后，使用 <code>import</code> 或 <code>require</code> 进行引用。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Graph <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@antv/x6'</span><span class="token punctuation">;</span>
</code></pre></div><p>如果是直接通过 <code>script</code> 标签引入，可以使用下面三个 CDN 中的任何一个，默认返回 X6 的最新版：</p> <ul><li>https://unpkg.com/@antv/x6/dist/x6.js</li> <li>https://cdn.jsdelivr.net/npm/@antv/x6/dist/x6.js</li> <li>https://cdnjs.cloudflare.com/ajax/libs/antv-x6/1.3.20/x6.js (不支持获取最新版)</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/@antv/x6/dist/x6.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>对于生产环境，我们推荐使用一个明确的版本号，以避免新版本造成的不可预期的破坏：</p> <ul><li>https://unpkg.com/@antv/x6@1.1.1/dist/x6.js</li> <li>https://cdn.jsdelivr.net/npm/@antv/x6@1.1.1/dist/x6.js</li> <li>https://cdnjs.cloudflare.com/ajax/libs/antv-x6/1.1.1/x6.js</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/@antv/x6@1.1.1/dist/x6.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="开始使用"><a href="#开始使用" class="header-anchor">#</a> 开始使用</h3> <p>接下来我们就一起来创建一个最简单的 <code>Hello --&gt; World</code> 应用。</p> <h4 id="step-1-创建容器"><a href="#step-1-创建容器" class="header-anchor">#</a> Step 1 创建容器</h4> <p>在页面中创建一个用于容纳 X6 绘图的容器，可以是一个 <code>div</code> 标签。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="step-2-准备数据"><a href="#step-2-准备数据" class="header-anchor">#</a> Step 2 准备数据</h4> <p>X6 支持 JSON 格式数据，该对象中需要有节点 <code>nodes</code> 和边 <code>edges</code> 字段，分别用数组表示：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 节点</span>
  nodes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span> <span class="token comment">// String，可选，节点的唯一标识</span>
      x<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>       <span class="token comment">// Number，必选，节点位置的 x 值</span>
      y<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>       <span class="token comment">// Number，必选，节点位置的 y 值</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>   <span class="token comment">// Number，可选，节点大小的 width 值</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>  <span class="token comment">// Number，可选，节点大小的 height 值</span>
      label<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token comment">// String，节点标签</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span> <span class="token comment">// String，节点的唯一标识</span>
      x<span class="token operator">:</span> <span class="token number">160</span><span class="token punctuation">,</span>      <span class="token comment">// Number，必选，节点位置的 x 值</span>
      y<span class="token operator">:</span> <span class="token number">180</span><span class="token punctuation">,</span>      <span class="token comment">// Number，必选，节点位置的 y 值</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>   <span class="token comment">// Number，可选，节点大小的 width 值</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>  <span class="token comment">// Number，可选，节点大小的 height 值</span>
      label<span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">,</span> <span class="token comment">// String，节点标签</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 边</span>
  edges<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      source<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span> <span class="token comment">// String，必须，起始节点 id</span>
      target<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span> <span class="token comment">// String，必须，目标节点 id</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="step-3-渲染画布"><a href="#step-3-渲染画布" class="header-anchor">#</a> Step 3 渲染画布</h4> <p>首先，我们需要创建一个 <code>Graph</code> 对象，并为其指定一个页面上的绘图容器，通常也会指定画布的大小。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Graph <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@antv/x6'</span><span class="token punctuation">;</span>
<span class="token comment">// 使用 CDN 引入时暴露了 X6 全局变量</span>
<span class="token comment">// const { Graph } = X6</span>

<span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  container<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  width<span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果是通过 <code>script</code> 标签引入方式，我们的 <code>Graph</code> 对象是挂载在 <code>X6</code> 这个全局变量下面：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/@antv/x6/dist/x6.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X6<span class="token punctuation">.</span>Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">container</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>然后，我们就可以使用刚刚创建的 <code>graph</code> 来渲染我们的节点和边。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span><span class="token function">fromJSON</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre></div><p>到此，我们就得到一个最简单的 <code>Hello --&gt; World</code> 示例，看下面的完整代码。</p> <iframe src="https://x6.antv.vision/demos/tutorial/getting-started/helloworld/" style="width:100%;height:375px;border:0;"></iframe> <h3 id="画布"><a href="#画布" class="header-anchor">#</a> 画布</h3> <h4 id="背景和网格"><a href="#背景和网格" class="header-anchor">#</a> 背景和网格</h4> <p>接下来，我们来给画布设置一个背景颜色和网格，另外还支持背景图片、网格类型等配置，点击查看完整的<a href="basic/background">背景配置</a>和<a href="basic/grid">网格配置</a>。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Graph <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@antv/x6'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  container<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  width<span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
  background<span class="token operator">:</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token string">'#fffbe6'</span><span class="token punctuation">,</span> <span class="token comment">// 设置画布背景颜色</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  grid<span class="token operator">:</span> <span class="token punctuation">{</span>
    size<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>      <span class="token comment">// 网格大小 10px</span>
    visible<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 渲染网格背景</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><iframe src="https://x6.antv.vision/demos/tutorial/getting-started/background" style="width:100%;height:375px;border:0;"></iframe> <h4 id="缩放和平移"><a href="#缩放和平移" class="header-anchor">#</a> 缩放和平移</h4> <p>创建画布后，可以调用 <code>graph.zoom(factor: number)</code> 和 <code>graph.translate(tx: number, ty: number)</code> 来缩放和平移画布。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span><span class="token function">zoom</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">)</span>
graph<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
</code></pre></div><iframe src="https://x6.antv.vision/demos/tutorial/getting-started/transform" style="width:100%;height:375px;border:0;"></iframe> <h3 id="节点"><a href="#节点" class="header-anchor">#</a> 节点</h3> <h4 id="使用图形"><a href="#使用图形" class="header-anchor">#</a> 使用图形</h4> <p>在上面示例中，我们使用了默认图形 <code>rect</code> 来渲染节点，除此之外，我们在 X6 中也内置了 <code>circle</code>、<code>ellipse</code>、<code>polygon</code> 等<a href="basic/cell#%E5%86%85%E7%BD%AE%E8%8A%82%E7%82%B9">基础图形</a>，可以通过 <code>shape</code> 属性为节点指定渲染的图形，如果你对 SVG 图形还不熟悉，可以参考 <a href="https://www.ruanyifeng.com/blog/2018/08/svg.html" target="_blank" rel="noopener noreferrer">SVG 图像入门教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  nodes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      shape<span class="token operator">:</span> <span class="token string">'rect'</span><span class="token punctuation">,</span> <span class="token comment">// 使用 rect 渲染</span>
      x<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      label<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
      shape<span class="token operator">:</span> <span class="token string">'ellipse'</span><span class="token punctuation">,</span> <span class="token comment">// 使用 ellipse 渲染</span>
      x<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      label<span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  edges<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      source<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      target<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><iframe src="https://x6.antv.vision/demos/tutorial/getting-started/node-shape" style="width:100%;height:375px;border:0;"></iframe> <h4 id="定制样式"><a href="#定制样式" class="header-anchor">#</a> 定制样式</h4> <p>在创建节点或准备节点数据时，我们可以通过 <code>attrs</code> 对象来配置节点样式，该对象的 Key 是节点 SVG 元素的选择器(Selector)，对应的值是应用到该 SVG 元素的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute" target="_blank" rel="noopener noreferrer">SVG 属性值<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>(如 <a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/fill" target="_blank" rel="noopener noreferrer">fill<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/stroke" target="_blank" rel="noopener noreferrer">stroke<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)，如果你对 SVG 属性还不熟悉，可以参考 MDN 提供的<a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Fills_and_Strokes" target="_blank" rel="noopener noreferrer">填充和边框<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>入门教程。</p> <p>我们对 <code>'rect'</code> 图形中定义了 <code>'body'</code>(代表 <code>&lt;rect&gt;</code> 元素) 和 <code>'label'</code>(代表 <code>&lt;text&gt;</code> 元素) 两个选择器(Selector)，每种图形都有属于自己的选择器定义，X6 内置图形<a href="basic/cell#attrs-1">参考这里</a>。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  nodes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      x<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      attrs<span class="token operator">:</span> <span class="token punctuation">{</span>
        body<span class="token operator">:</span> <span class="token punctuation">{</span>
          fill<span class="token operator">:</span> <span class="token string">'#2ECC71'</span><span class="token punctuation">,</span>
          stroke<span class="token operator">:</span> <span class="token string">'#000'</span><span class="token punctuation">,</span>
          strokeDasharray<span class="token operator">:</span> <span class="token string">'10,2'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token punctuation">{</span>
          text<span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span>
          fill<span class="token operator">:</span> <span class="token string">'#333'</span><span class="token punctuation">,</span>
          fontSize<span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
      x<span class="token operator">:</span> <span class="token number">180</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      attrs<span class="token operator">:</span> <span class="token punctuation">{</span>
        body<span class="token operator">:</span> <span class="token punctuation">{</span>
          fill<span class="token operator">:</span> <span class="token string">'#F39C12'</span><span class="token punctuation">,</span>
          stroke<span class="token operator">:</span> <span class="token string">'#000'</span><span class="token punctuation">,</span>
          rx<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
          ry<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token punctuation">{</span>
          text<span class="token operator">:</span> <span class="token string">'World'</span><span class="token punctuation">,</span>
          fill<span class="token operator">:</span> <span class="token string">'#333'</span><span class="token punctuation">,</span>
          fontSize<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
          fontWeight<span class="token operator">:</span> <span class="token string">'bold'</span><span class="token punctuation">,</span>
          fontVariant<span class="token operator">:</span> <span class="token string">'small-caps'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  edges<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      source<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      target<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><iframe src="https://x6.antv.vision/demos/tutorial/getting-started/node-style" style="width:100%;height:375px;border:0;"></iframe> <h3 id="边"><a href="#边" class="header-anchor">#</a> 边</h3> <h4 id="使用图形-2"><a href="#使用图形-2" class="header-anchor">#</a> 使用图形</h4> <p>在上面示例中，我们使用了默认图形 <code>edge</code> 来渲染边，除此之外，在 X6 中还内置了 <code>double-edge</code> 和 <code>shadow-edge</code> 两种图形，可以通过 <code>shape</code> 属性为边指定渲染的图形，例如：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  nodes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      shape<span class="token operator">:</span> <span class="token string">'rect'</span><span class="token punctuation">,</span>
      x<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      label<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
      shape<span class="token operator">:</span> <span class="token string">'ellipse'</span><span class="token punctuation">,</span>
      x<span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      label<span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  edges<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      source<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      target<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
      shape<span class="token operator">:</span> <span class="token string">'double-edge'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><iframe src="https://x6.antv.vision/demos/tutorial/getting-started/edge-shape" style="width:100%;height:375px;border:0;"></iframe> <h4 id="定制样式-2"><a href="#定制样式-2" class="header-anchor">#</a> 定制样式</h4> <p>与<a href="#%E5%AE%9A%E5%88%B6%E6%A0%B7%E5%BC%8F">定制节点样式</a>一样，我们使用 <code>attrs</code> 对象来配置边的样式，默认的 <code>edge</code> 图形定义了 <code>'line'</code>（<code>&lt;path&gt;</code> 元素） 和 <code>'wrap'</code>（透明的 <code>&lt;path&gt;</code> 元素，更宽但不可见，为了方便交互）两个选择器(Selector)，我们像下面这样来定制边的样式。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  nodes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      shape<span class="token operator">:</span> <span class="token string">'rect'</span><span class="token punctuation">,</span>
      x<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      label<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
      shape<span class="token operator">:</span> <span class="token string">'ellipse'</span><span class="token punctuation">,</span>
      x<span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      label<span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  edges<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      source<span class="token operator">:</span> <span class="token string">'node1'</span><span class="token punctuation">,</span>
      target<span class="token operator">:</span> <span class="token string">'node2'</span><span class="token punctuation">,</span>
      attrs<span class="token operator">:</span> <span class="token punctuation">{</span>
        line<span class="token operator">:</span> <span class="token punctuation">{</span>
          stroke<span class="token operator">:</span> <span class="token string">'orange'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><iframe src="https://x6.antv.vision/demos/tutorial/getting-started/edge-style" style="width:100%;height:375px;border:0;"></iframe> <h2 id="基本教程"><a href="#基本教程" class="header-anchor">#</a> 基本教程</h2> <p>在 X6 中，Graph 是图的载体，它包含了图上的所有元素（节点、边等），同时挂载了图的相关操作（如交互监听、元素操作、渲染等）。</p> <h3 id="画布-graph-平移、缩放、居中"><a href="#画布-graph-平移、缩放、居中" class="header-anchor">#</a> 画布 Graph 平移、缩放、居中</h3> <h4 id="画布平移"><a href="#画布平移" class="header-anchor">#</a> 画布平移</h4> <p>普通画布(未开启 <a href="/zh/docs/tutorial/basic/scroller">scroller</a> 模式)通过开启 <code>panning</code> 选项来支持拖拽平移。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  panning<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  panning<span class="token operator">:</span> <span class="token punctuation">{</span>
    enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>拖拽可能和其他操作冲突，此时可以设置 <code>modifiers</code> 参数，设置修饰键后需要按下修饰键并点击鼠标才能触发画布拖拽。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  panning<span class="token operator">:</span> <span class="token punctuation">{</span>
    enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    modifiers<span class="token operator">:</span> <span class="token string">'shift'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>还可以配置 <code>eventTypes</code> 来设置触发画布拖拽的行为，支持 <code>leftMouseDown</code>、 <code>rightMouseDown</code>、<code>mouseWheel</code>，默认为 <code>['leftMouseDown']</code> 。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  panning<span class="token operator">:</span> <span class="token punctuation">{</span>
    enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    eventTypes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'leftMouseDown'</span><span class="token punctuation">,</span> <span class="token string">'rightMouseDown'</span><span class="token punctuation">,</span> <span class="token string">'mouseWheel'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>可以通过以下 API 来启用/禁止画布平移：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span><span class="token function">isPannable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 画布是否可以平移</span>
graph<span class="token punctuation">.</span><span class="token function">enablePanning</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 启用画布平移</span>
graph<span class="token punctuation">.</span><span class="token function">disablePanning</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 禁止画布平移</span>
graph<span class="token punctuation">.</span><span class="token function">togglePanning</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 切换画布平移状态</span>
</code></pre></div><h4 id="画布缩放"><a href="#画布缩放" class="header-anchor">#</a> 画布缩放</h4> <p>普通画布(未开启 <a href="/zh/docs/tutorial/basic/scroller">scroller</a> 模式)通过开启 <a href="/zh/docs/tutorial/basic/mousewheel">mousewheel</a> 选项来支持画布缩放。这里说明怎么通过代码来进行画布缩放：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span><span class="token function">zoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取缩放级别</span>
graph<span class="token punctuation">.</span><span class="token function">zoom</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment">// 在原来缩放级别上增加 0.2</span>
graph<span class="token punctuation">.</span><span class="token function">zoom</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment">// 在原来缩放级别上减少 0.2</span>
</code></pre></div><h4 id="内容居中"><a href="#内容居中" class="header-anchor">#</a> 内容居中</h4> <p>常用的就是将画布内容中心与视口中心对齐，使用方式：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span><span class="token function">centerContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>更多的居中方法可以查看 <a href="/zh/docs/api/graph/transform">Transform</a></p> <h3 id="导出"><a href="#导出" class="header-anchor">#</a> 导出</h3> <h4 id="导出-svg"><a href="#导出-svg" class="header-anchor">#</a> 导出 SVG</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">this</span><span class="token punctuation">.</span>graph<span class="token punctuation">.</span><span class="token function">toSVG</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataUri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 下载</span>
  DataUri<span class="token punctuation">.</span><span class="token function">downloadDataUri</span><span class="token punctuation">(</span>DataUri<span class="token punctuation">.</span><span class="token function">svgToDataUrl</span><span class="token punctuation">(</span>dataUri<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'chart.svg'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>toSVG</code> 方法还支持第二个参数：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">ToSVGOptions</span> <span class="token punctuation">{</span>
  preserveDimensions<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> Size
  viewBox<span class="token operator">?</span><span class="token operator">:</span> Rectangle<span class="token punctuation">.</span>RectangleLike
  copyStyles<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  stylesheet<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  serializeImages<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  beforeSerialize<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> Graph<span class="token punctuation">,</span> svg<span class="token operator">:</span> SVGSVGElement<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="preservedimensions"><a href="#preservedimensions" class="header-anchor">#</a> preserveDimensions</h4> <p><code>preserveDimensions</code> 用来控制导出 <code>svg</code> 的尺寸, 如果不设置，<code>width</code> 和 <code>height</code> 默认为 <code>100%</code>；如果设置为 <code>true</code>, <code>width</code> 和 <code>height</code> 会自动计算为图形区域的实际大小。还可以通过以下方式自定义尺寸：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">this</span><span class="token punctuation">.</span>graph<span class="token punctuation">.</span><span class="token function">toSVG</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataUri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// todo</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  preserveDimensions<span class="token operator">:</span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="viewbox"><a href="#viewbox" class="header-anchor">#</a> viewBox</h5> <p>设置导出 <code>svg</code> 的 <code>viewBox</code></p> <h4 id="copystyles"><a href="#copystyles" class="header-anchor">#</a> copyStyles</h4> <p>是否复制外部样式表中的样式，默认是 <code>true</code>。开启 <code>copyStyles</code> 后，在导出过程中因为需要禁用所有样式表，所以页面可能会出现短暂的样式丢失现象。如果效果特别差，可以将 <code>copyStyles</code> 设置为 <code>false</code>。</p> <h4 id="stylesheet"><a href="#stylesheet" class="header-anchor">#</a> stylesheet</h4> <p>自定义样式表</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">this</span><span class="token punctuation">.</span>graph<span class="token punctuation">.</span><span class="token function">toSVG</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataUri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// todo</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  stylesheet<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    rect {
      fill: red;
    }
  </span><span class="token template-punctuation string">`</span></span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="serializeimages"><a href="#serializeimages" class="header-anchor">#</a> serializeImages</h5> <p>是否将 <code>image</code> 元素的 <code>xlink:href</code> 链接转化为 <code>dataUri</code> 格式</p> <h5 id="beforeserialize"><a href="#beforeserialize" class="header-anchor">#</a> beforeSerialize</h5> <p>可以在导出 <code>svg</code> 字符串之前调用 <code>beforeSerialize</code> 来修改它。</p> <h4 id="导出-png-jpeg"><a href="#导出-png-jpeg" class="header-anchor">#</a> 导出 PNG/JPEG</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> DataUri <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@antv/x6'</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>graph<span class="token punctuation">.</span><span class="token function">toPNG</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataUri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 下载</span>
  DataUri<span class="token punctuation">.</span><span class="token function">downloadDataUri</span><span class="token punctuation">(</span>dataUri<span class="token punctuation">,</span> <span class="token string">'chart.png'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>toPNG/toJPEG</code> 方法第二个参数除了 <code>toSVG</code> 的所有参数外，还支持以下参数：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">ToImageOptions</span> <span class="token punctuation">{</span>
  width<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
  height<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
  backgroundColor<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
  padding<span class="token operator">?</span><span class="token operator">:</span> NumberExt<span class="token punctuation">.</span>SideOptions
  quality<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="width"><a href="#width" class="header-anchor">#</a> width</h5> <p>导出图片的宽度</p> <h5 id="height"><a href="#height" class="header-anchor">#</a> height</h5> <p>导出图片的高度</p> <h5 id="backgroundcolor"><a href="#backgroundcolor" class="header-anchor">#</a> backgroundColor</h5> <p>导出图片的背景色</p> <h5 id="padding"><a href="#padding" class="header-anchor">#</a> padding</h5> <p>图片的 <code>padding</code></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">this</span><span class="token punctuation">.</span>graph<span class="token punctuation">.</span><span class="token function">toPNG</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataUri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 下载</span>
  DataUri<span class="token punctuation">.</span><span class="token function">downloadDataUri</span><span class="token punctuation">(</span>dataUri<span class="token punctuation">,</span> <span class="token string">'chart.png'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  padding<span class="token operator">:</span> <span class="token punctuation">{</span>
    top<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    right<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
    bottom<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
    left<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="quality"><a href="#quality" class="header-anchor">#</a> quality</h5> <p>图片质量，可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 <code>0.92</code></p> <h3 id="销毁画布"><a href="#销毁画布" class="header-anchor">#</a> 销毁画布</h3> <p>我们可以调用 <code>graph.dispose()</code> 方法进行画布的销毁以及资源的回收。</p> <h2 id="项目中用到的方法"><a href="#项目中用到的方法" class="header-anchor">#</a> 项目中用到的方法</h2> <h3 id="draggable"><a href="#draggable" class="header-anchor">#</a> draggable</h3> <ul><li>给需要拖拽的元素添加 draggable 属性并设置为 true，然后添加 ondrag 事件。</li> <li>给接收拖拽元素的放置元素同时设置 ondragover 和 ondrop 事件，必须在里边阻止默认事件，因为浏览器对拖拽事件默认的处理方式是禁止拖拽</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div
    ref<span class="token operator">=</span><span class="token string">&quot;draggable&quot;</span>
    <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;draggable-box&quot;</span>
    draggable<span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">dragstart</span></span><span class="token operator">=</span><span class="token string">&quot;onDragstart&quot;</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">drag</span></span><span class="token operator">=</span><span class="token string">&quot;onDrag&quot;</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">dragend</span></span><span class="token operator">=</span><span class="token string">&quot;onDragend&quot;</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> setup<span class="token operator">&gt;</span>
  <span class="token keyword">const</span> dragEmit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'onDragStart'</span><span class="token punctuation">,</span> <span class="token string">'onDrag'</span><span class="token punctuation">,</span> <span class="token string">'onDragEnd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">onDragstart</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dragEmit</span><span class="token punctuation">(</span><span class="token string">'onDragStart'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> <span class="token function-variable function">onDrag</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dragEmit</span><span class="token punctuation">(</span><span class="token string">'onDrag'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> <span class="token function-variable function">onDragend</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dragEmit</span><span class="token punctuation">(</span><span class="token string">'onDragEnd'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

 <span class="token operator">&lt;</span>div
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">dragenter</span></span><span class="token punctuation">.</span>prevent
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">dragover</span></span><span class="token punctuation">.</span>prevent
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">dragleave</span></span><span class="token punctuation">.</span>prevent
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">drop</span></span><span class="token punctuation">.</span>stop<span class="token punctuation">.</span>prevent<span class="token operator">=</span><span class="token string">&quot;onEmptyDrop&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="连线验证-validateconnection"><a href="#连线验证-validateconnection" class="header-anchor">#</a> 连线验证（validateConnection）</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">validateConnection</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>
      sourceMagnet<span class="token punctuation">,</span>
      targetMagnet<span class="token punctuation">,</span>
      sourceCell<span class="token punctuation">,</span>
      targetCell<span class="token punctuation">,</span>
      targetView<span class="token punctuation">,</span>
      sourcePort<span class="token punctuation">,</span>
      edge<span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token operator">=</span> data
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sourceCell <span class="token operator">&amp;&amp;</span> targetCell <span class="token operator">&amp;&amp;</span> sourceCell<span class="token punctuation">.</span><span class="token function">isNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> targetCell<span class="token punctuation">.</span><span class="token function">isNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 起点不能是输入连接幢</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sourceMagnet <span class="token operator">||</span> sourceMagnet<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'port-group'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">X6_PORT_IN_NAME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 目标链接幢只能是输入</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>targetMagnet <span class="token operator">||</span> targetMagnet<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'port-group'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant">X6_PORT_IN_NAME</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 输入连接幢 只能有一个连线</span>
      <span class="token keyword">const</span> portId <span class="token operator">=</span> targetMagnet<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'port'</span><span class="token punctuation">)</span><span class="token operator">!</span>
      <span class="token keyword">const</span> node<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> targetView<span class="token operator">!</span><span class="token punctuation">.</span>cell
      <span class="token keyword">const</span> port <span class="token operator">=</span> node<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span>portId<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>port <span class="token operator">&amp;&amp;</span> port<span class="token punctuation">.</span>connected<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 此处后续可添加 节点是否失效逻辑</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>sourcePort <span class="token operator">===</span> <span class="token constant">FILTER_OUT_PORT_YES</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      edge<span class="token operator">?.</span><span class="token function">setLabels</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          attrs<span class="token operator">:</span> <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">'YES'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sourcePort <span class="token operator">===</span> <span class="token constant">FILTER_OUT_PORT_NO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      edge<span class="token operator">?.</span><span class="token function">setLabels</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          attrs<span class="token operator">:</span> <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">'NO'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="事件系统"><a href="#事件系统" class="header-anchor">#</a> 事件系统</h3> <h4 id="右键菜单及自定义事件"><a href="#右键菜单及自定义事件" class="header-anchor">#</a> 右键菜单及自定义事件</h4> <ul><li>右键	cell:contextmenu	node:contextmenu	edge:contextmenu	blank:contextmenu</li> <li>自定义事件 cell:customevent、node:customevent、edge:customevent</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'cell:contextmenu'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> e <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  nodeVariables<span class="token punctuation">.</span>menuCell <span class="token operator">=</span> cell <span class="token keyword">as</span> Cell
  nodeVariables<span class="token punctuation">.</span>menuVisible <span class="token operator">=</span> <span class="token boolean">true</span>
  nodeVariables<span class="token punctuation">.</span>eventType <span class="token operator">=</span> <span class="token string">'contextmenu'</span>
  <span class="token keyword">const</span> pos <span class="token operator">=</span> graph<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">clientToGraph</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>pageX <span class="token operator">+</span> <span class="token number">200</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>pageY <span class="token operator">+</span> <span class="token number">80</span><span class="token punctuation">)</span>
  nodeVariables<span class="token punctuation">.</span>pageX <span class="token operator">=</span> pos<span class="token operator">?.</span>x <span class="token keyword">as</span> <span class="token builtin">number</span>
  nodeVariables<span class="token punctuation">.</span>pageY <span class="token operator">=</span> pos<span class="token operator">?.</span>y <span class="token keyword">as</span> <span class="token builtin">number</span>
  graph<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">lockScroller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>自定义事件监听的并不是一个完整的点击事件，当鼠标按下那一刻，就触发了；这样就会导致一个问题，它与clickOutSide的触发时机问题</p></div> <h3 id="节点-边"><a href="#节点-边" class="header-anchor">#</a> 节点/边</h3> <h4 id="添加-删除-修改"><a href="#添加-删除-修改" class="header-anchor">#</a> 添加/删除/修改</h4> <p>当节点/边被添加到画布时，触发以下事件：</p> <ul><li><code>added</code></li> <li><code>cell:added</code></li> <li><code>node:added</code>（仅当 cell 是节点时才触发）</li> <li><code>edge:added</code>（仅当 cell 是边时才触发）</li></ul> <p>当节点/边被移除时，触发以下事件：</p> <ul><li><code>removed</code></li> <li><code>cell:removed</code></li> <li><code>node:removed</code>（仅当 cell 是节点时才触发）</li> <li><code>edge:removed</code>（仅当 cell 是边时才触发）</li></ul> <p>当节点/边发生任何改变时，触发以下事件：</p> <ul><li><code>changed</code></li> <li><code>cell:changed</code></li> <li><code>node:changed</code>（仅当 cell 是节点时才触发）</li> <li><code>edge:changed</code>（仅当 cell 是边时才触发）</li></ul> <p>可以在节点/边上监听：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'added'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
cell<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'removed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
cell<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'changed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>或者在 Graph 上监听：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'cell:added'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'cell:removed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'cell:changed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'node:added'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> node<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'node:removed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> node<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'node:changed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> node<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'edge:added'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> edge<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'edge:removed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> edge<span class="token punctuation">,</span> index<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'edge:changed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> edge<span class="token punctuation">,</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="change-xxx"><a href="#change-xxx" class="header-anchor">#</a> change:xxx</h4> <p>当调用 <code>setXxx(val, options)</code> 和 <code>removeXxx(options)</code> 方法去改变节点/边的数据时，并且 <code>options.silent</code> 不为 <code>true</code> 时，都将触发对应的 <code>chang</code> 事件，并触发节点/边重绘。例如：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setZIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
cell<span class="token punctuation">.</span><span class="token function">setZIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> silent<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
cell<span class="token punctuation">.</span><span class="token function">setZIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> anyKey<span class="token operator">:</span> <span class="token string">'anyValue'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>将触发 Cell 上的以下事件：</p> <ul><li><code>change:*</code></li> <li><code>change:zIndex</code></li></ul> <p>和 Graph 上的以下事件：</p> <ul><li><code>cell:change:*</code></li> <li><code>node:change:*</code>（仅当 cell 是节点时才触发）</li> <li><code>edge:change:*</code>（仅当 cell 是边时才触发）</li> <li><code>cell:change:zIndex</code></li> <li><code>node:change:zIndex</code>（仅当 cell 是节点时才触发）</li> <li><code>edge:change:zIndex</code>（仅当 cell 是边时才触发）</li></ul> <p>可以在节点/边上监听：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 当 cell 发生任何改变时都将被触发，可以通过 key 来确定改变项</span>
cell<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change:*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell    
  key<span class="token operator">:</span> <span class="token builtin">string</span>   <span class="token comment">// 通过 key 来确定改变项</span>
  current<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 当前值</span>
  previous<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token comment">// 改变之前的值</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'zIndex'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// </span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

cell<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change:zIndex'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell
  current<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>  <span class="token comment">// 当前值</span>
  previous<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token comment">// 改变之前的值</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>      <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>或者在 Graph 上监听：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'cell:change:*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell    
  key<span class="token operator">:</span> <span class="token builtin">string</span>   <span class="token comment">// 通过 key 来确定改变项</span>
  current<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 当前值，类型根据 key 指代的类型确定</span>
  previous<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token comment">// 改变之前的值，类型根据 key 指代的类型确定</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 当 cell 为节点时触发</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'node:change:*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell    
  node<span class="token operator">:</span> Node
  key<span class="token operator">:</span> <span class="token builtin">string</span>   <span class="token comment">// 通过 key 来确定改变项</span>
  current<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 当前值，类型根据 key 指代的类型确定</span>
  previous<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token comment">// 改变之前的值，类型根据 key 指代的类型确定</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 当 cell 为边时触发</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'edge:change:*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell    
  edge<span class="token operator">:</span> Edge
  key<span class="token operator">:</span> <span class="token builtin">string</span>   <span class="token comment">// 通过 key 来确定改变项</span>
  current<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 当前值，类型根据 key 指代的类型确定</span>
  previous<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token comment">// 改变之前的值，类型根据 key 指代的类型确定</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>  <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'cell:change:zIndex'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell
  current<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>  <span class="token comment">// 当前值</span>
  previous<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token comment">// 改变之前的值</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>      <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 当 cell 为节点时触发</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'node:change:zIndex'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell
  node<span class="token operator">:</span> Node
  current<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>  <span class="token comment">// 当前值</span>
  previous<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token comment">// 改变之前的值</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>      <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 当 cell 为边时触发</span>
graph<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'edge:change:zIndex'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token punctuation">{</span>
  cell<span class="token operator">:</span> Cell
  edge<span class="token operator">:</span> Edge        
  current<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>  <span class="token comment">// 当前值</span>
  previous<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token comment">// 改变之前的值</span>
  options<span class="token operator">:</span> <span class="token builtin">any</span>      <span class="token comment">// 透传的 options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>其他 <code>change</code> 事件如下列表，回调函数的参数与上面提到的 <code>change:zIndex</code> 的参数结构一致。</p> <ul><li>Cell
<ul><li><code>change:*</code></li> <li><code>change:attrs</code></li> <li><code>change:zIndex</code></li> <li><code>change:markup</code></li> <li><code>change:visible</code></li> <li><code>change:parent</code></li> <li><code>change:children</code></li> <li><code>change:view</code></li> <li><code>change:data</code></li></ul></li> <li>Node
<ul><li><code>change:size</code></li> <li><code>change:angle</code></li> <li><code>change:position</code></li> <li><code>change:ports</code></li> <li><code>change:portMarkup</code></li> <li><code>change:portLabelMarkup</code></li> <li><code>change:portContainerMarkup</code></li> <li><code>ports:added</code></li> <li><code>ports:removed</code></li></ul></li> <li>Edge
<ul><li><code>change:source</code></li> <li><code>change:target</code></li> <li><code>change:terminal</code></li> <li><code>change:router</code></li> <li><code>change:connector</code></li> <li><code>change:vertices</code></li> <li><code>change:labels</code></li> <li><code>change:defaultLabel</code></li> <li><code>change:toolMarkup</code></li> <li><code>change:doubleToolMarkup</code></li> <li><code>change:vertexMarkup</code></li> <li><code>change:arrowheadMarkup</code></li> <li><code>vertexs:added</code></li> <li><code>vertexs:removed</code></li> <li><code>labels:added</code></li> <li><code>labels:removed</code></li></ul></li></ul> <p>除了上述这些内置的 Key，我们也支持监听自定义的 Key，例如</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change:custom'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> cell<span class="token punctuation">,</span> current<span class="token punctuation">,</span> previous<span class="token punctuation">,</span> options<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>当通过 <code>cell.prop('custom', 'any data')</code> 方法修改 <code>custom</code> 属性的值时将触发 <code>change:custom</code> 事件。</p> <h4 id="isnode"><a href="#isnode" class="header-anchor">#</a> isNode()</h4> <div class="language-sign extra-class"><pre class="language-text"><code>isNode(): boolean
</code></pre></div><p>检测实例是不是 <a href="/zh/docs/api/model/node">Node</a> 实例，如果是 <a href="/zh/docs/api/model/node">Node</a> 实例则返回 <code>true</code>，否则返回 <code>false</code>。所有继承自 <a href="/zh/docs/api/model/node">Node</a> 的节点都返回 <code>true</code>。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">isNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something if the cell is a node.</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="cell"><a href="#cell" class="header-anchor">#</a> Cell</h3> <h4 id="isedge"><a href="#isedge" class="header-anchor">#</a> isEdge()</h4> <div class="language-sign extra-class"><pre class="language-text"><code>isEdge(): boolean
</code></pre></div><p>检测实例是不是 <a href="/zh/docs/api/model/edge">Edge</a> 实例，如果是 <a href="/zh/docs/api/model/edge">Edge</a> 实例则返回 <code>true</code>，否则返回 <code>false</code>。所有继承自 <a href="/zh/docs/api/model/edge">Edge</a> 的边都返回 <code>true</code>。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">isEdge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something if the cell is an edge.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="元素属性-attrs"><a href="#元素属性-attrs" class="header-anchor">#</a> 元素属性 attrs</h4> <p>属性 <code>attrs</code> 是一个<a href="#attrs-1">复杂对象</a>，当修改 <code>attrs</code> 时，将触发 <code>'change:attrs'</code> 事件和画布重绘。</p> <h5 id="get-attrs"><a href="#get-attrs" class="header-anchor">#</a> get attrs</h5> <p>获取属性。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> atts <span class="token operator">=</span> cell<span class="token punctuation">.</span>attrs
</code></pre></div><h5 id="set-attrs"><a href="#set-attrs" class="header-anchor">#</a> set attrs</h5> <p>设置属性，并触发 <code>'change:attrs'</code> 事件和画布重绘。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span>atts <span class="token operator">=</span> attrs
</code></pre></div><h5 id="getattrs"><a href="#getattrs" class="header-anchor">#</a> getAttrs()</h5> <div class="language-sign extra-class"><pre class="language-text"><code>getAttrs(): Attr.CellAttrs
</code></pre></div><p>获取属性。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> atts <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="setattrs"><a href="#setattrs" class="header-anchor">#</a> setAttrs(...)</h5> <div class="language-sign extra-class"><pre class="language-text"><code>setAttrs(attrs: Attr.CellAttrs, options?: Cell.SetAttrOptions): this
</code></pre></div><p>设置属性，默认情况触发 <code>'change:attrs'</code> 事件和画布重绘。</p> <table><thead><tr><th>名称</th> <th>类型</th> <th style="text-align:center;">必选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>attrs</td> <td>Attr.CellAttrs | null | undefined</td> <td style="text-align:center;">✓</td> <td></td> <td></td></tr> <tr><td>options.overwrite</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>为 <code>true</code> 时替换现有属性，否则根据 <code>options.deep</code> 选项进行深度或浅度 merge。</td></tr> <tr><td>options.deep</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>true</code></td> <td>当 <code>options.overwrite</code> 为 <code>false</code> 时有效， 为 <code>true</code> 时进行深度 merge，否则进行浅 merge。</td></tr> <tr><td>options.silent</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>为 <code>true</code> 时不触发 <code>'change:attrs'</code> 事件和画布重绘。</td></tr> <tr><td>options...others</td> <td>object</td> <td style="text-align:center;"></td> <td></td> <td>其他自定义键值对，可以在事件回调中使用。</td></tr></tbody></table> <p>默认情况，指定的属性将与旧属性进行<a href="https://www.lodashjs.com/docs/latest#_mergeobject-sources" target="_blank" rel="noopener noreferrer">深度 merge<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   body: { fill: '#ffffff' },</span>
<span class="token comment">//   label: { fill: '#333333' },</span>
<span class="token comment">// }</span>

cell<span class="token punctuation">.</span><span class="token function">setAttrs</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  body<span class="token operator">:</span> <span class="token punctuation">{</span> fill<span class="token operator">:</span> <span class="token string">'#f5f5f5'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  label<span class="token operator">:</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">'My Label'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   body: { fill: '#f5f5f5' },</span>
<span class="token comment">//   label: { fill: '#333333', text: 'My Label' },</span>
<span class="token comment">// }</span>
</code></pre></div><p>当 <code>options.deep</code> 为 <code>false</code> 时，进行浅 merge：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   body: { fill: '#ffffff' },</span>
<span class="token comment">//   label: { fill: '#333333' },</span>
<span class="token comment">// }</span>

cell<span class="token punctuation">.</span><span class="token function">setAttrs</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">'My Label'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token punctuation">{</span> deep<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   body: { fill: '#ffffff' },</span>
<span class="token comment">//   label: { text: 'My Label' },</span>
<span class="token comment">// }</span>
</code></pre></div><p>当 <code>options.overwrite</code> 为 <code>true</code> 时，直接替换旧属性：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   body: { fill: '#ffffff' },</span>
<span class="token comment">//   label: { fill: '#333333' },</span>
<span class="token comment">// }</span>

cell<span class="token punctuation">.</span><span class="token function">setAttrs</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">'My Label'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token punctuation">{</span> overwrite<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// {</span>
<span class="token comment">//   label: { text: 'My Label' },</span>
<span class="token comment">// }</span>
</code></pre></div><p>当 <code>options.silent</code> 为 true 时不触发 <code>'change:attrs'</code> 事件和画布重绘。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setAttrs</span><span class="token punctuation">(</span>myAttrs<span class="token punctuation">,</span> <span class="token punctuation">{</span> silent<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>在选项中支持其他自定义键值对，可以在事件回调用使用。</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setAttrs</span><span class="token punctuation">(</span>myAttrs<span class="token punctuation">,</span> <span class="token punctuation">{</span> otherKey<span class="token operator">:</span> <span class="token string">'otherValue'</span><span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="updateattrs"><a href="#updateattrs" class="header-anchor">#</a> updateAttrs(...)</h4> <div class="language-sign extra-class"><pre class="language-text"><code>updateAttrs(attrs: Attr.CellAttrs, options: Cell.SetOptions = {}): this
</code></pre></div><p>使用浅 merge 更新属性，相当于调用 <code>setAttrs(attrs, { ...options, deep: false })</code>。</p> <table><thead><tr><th>名称</th> <th>类型</th> <th style="text-align:center;">必选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>attrs</td> <td>Attr.CellAttrs | null | undefined</td> <td style="text-align:center;">✓</td> <td></td> <td></td></tr> <tr><td>options.silent</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>为 <code>true</code> 时不触发 <code>'change:attrs'</code> 事件和画布重绘。</td></tr> <tr><td>options...others</td> <td>object</td> <td style="text-align:center;"></td> <td></td> <td>其他自定义键值对，可以在事件回调中使用。</td></tr></tbody></table> <h4 id="get-data"><a href="#get-data" class="header-anchor">#</a> get data</h4> <p>获取关联的数据。</p> <h4 id="set-data"><a href="#set-data" class="header-anchor">#</a> set data</h4> <p>设置关联的数据，并触发 <code>'change:data'</code> 事件和画布重绘。</p> <h4 id="getdata"><a href="#getdata" class="header-anchor">#</a> getData()</h4> <div class="language-sign extra-class"><pre class="language-text"><code>getData(): any
</code></pre></div><p>获取关联的数据。</p> <h4 id="setdata"><a href="#setdata" class="header-anchor">#</a> setData(...)</h4> <div class="language-sign extra-class"><pre class="language-text"><code>setData(data: any, options?: Cell.SetDataOptions): this
</code></pre></div><p>设置关联的业务数据。</p> <p>默认情况触发 <code>'change:data'</code> 事件和画布重绘，当 <code>options.silent</code> 为 <code>true</code> 时不触发 <code>'change:data'</code> 事件和画布重绘。</p> <table><thead><tr><th>名称</th> <th>类型</th> <th style="text-align:center;">必选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>data</td> <td>any</td> <td style="text-align:center;">✓</td> <td></td> <td></td></tr> <tr><td>options.overwrite</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>为 <code>true</code> 时替换现有值，否则根据 <code>options.deep</code> 选项进行深度或浅度 merge。</td></tr> <tr><td>options.deep</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>true</code></td> <td>当 <code>options.overwrite</code> 为 <code>false</code> 时有效， 为 <code>true</code> 时进行深度 merge，否则进行浅 merge。</td></tr> <tr><td>options.silent</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>为 <code>true</code> 时不触发 <code>'change:data'</code> 事件和画布重绘。</td></tr> <tr><td>options...others</td> <td>object</td> <td style="text-align:center;"></td> <td></td> <td>其他自定义键值对，可以在事件回调中使用。</td></tr></tbody></table> <p>默认与原数据进行<a href="https://www.lodashjs.com/docs/latest#_mergeobject-sources" target="_blank" rel="noopener noreferrer">深度 merge<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，并触发 <code>'change:data'</code> 事件和画布重绘：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre></div><p>当 <code>options.overwrite</code> 为 <code>true</code> 时，替换旧数据：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> overwrite<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>当 <code>options.deep</code> 为 <code>false</code> 时，与原数据进行浅 merge：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> overwrite<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>当 <code>options.silent</code> 为 <code>true</code> 时，不触发 <code>'change:data'</code> 事件和画布重绘：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> silent<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>在选项中支持其他自定义键值对，可以在事件回调用使用：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>cell<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> otherKey<span class="token operator">:</span> <span class="token string">'otherValue'</span><span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="updatedata"><a href="#updatedata" class="header-anchor">#</a> updateData(...)</h4> <div class="language-sign extra-class"><pre class="language-text"><code>updateData(data: any, options: Cell.SetOptions = {}): this
</code></pre></div><p>通过浅 merge 来更新数据，相当于调用 <code>setData(data, { ...options, deep: false })</code>。</p> <table><thead><tr><th>名称</th> <th>类型</th> <th style="text-align:center;">必选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>data</td> <td>any</td> <td style="text-align:center;">✓</td> <td></td> <td></td></tr> <tr><td>options.silent</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>为 <code>true</code> 时不触发 <code>'change:data'</code> 事件和画布重绘。</td></tr> <tr><td>options...others</td> <td>object</td> <td style="text-align:center;"></td> <td></td> <td>其他自定义键值对，可以在事件回调中使用。</td></tr></tbody></table> <h3 id="model"><a href="#model" class="header-anchor">#</a> Model</h3> <h4 id="getneighbors"><a href="#getneighbors" class="header-anchor">#</a> getNeighbors(...)</h4> <div class="language-sign extra-class"><pre class="language-text"><code>getNeighbors(cell: Cell, options?: GetNeighborsOptions): Cell[]
</code></pre></div><p>获取邻居节点。</p> <table><thead><tr><th>名称</th> <th>类型</th> <th style="text-align:center;">必选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>cell</td> <td>Cell</td> <td style="text-align:center;">✓</td> <td></td> <td>节点/边。</td></tr> <tr><td>options.incoming</td> <td>boolean</td> <td style="text-align:center;"></td> <td>-</td> <td>是否包含输入侧的邻居节点，默认包含输入和输出侧的节点，<code>incoming</code> 和 <code>outgoing</code> 两个选项中，当 <code>incoming</code> 为 <code>true</code> 时只返回输入侧的节点。</td></tr> <tr><td>options.outgoing</td> <td>boolean</td> <td style="text-align:center;"></td> <td>-</td> <td>是否包含输出侧的邻居节点，默认包含输入和输出侧的节点，<code>incoming</code> 和 <code>outgoing</code> 两个选项中，当 <code>outgoing</code> 为 <code>true</code> 时只返回输出侧的节点。</td></tr> <tr><td>options.deep</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>是否递归获取所有子节点/边，为 <code>true</code> 时将同时返回所有子孙节点/边的邻居节点。</td></tr> <tr><td>options.indirect</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>是否包含哪些间接连接的邻居节点，即中间包含多条边(边与边连接)的邻居。</td></tr></tbody></table> <h4 id="getpredecessors"><a href="#getpredecessors" class="header-anchor">#</a> getPredecessors(...)</h4> <div class="language-sign extra-class"><pre class="language-text"><code>getPredecessors(cell: Cell, options?: GetPredecessorsOptions): Cell[]
</code></pre></div><p>返回节点的前序节点，即从根节点开始连接到指定节点的节点。</p> <table><thead><tr><th>名称</th> <th>类型</th> <th style="text-align:center;">必选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>cell</td> <td>Cell</td> <td style="text-align:center;">✓</td> <td></td> <td>节点/边。</td></tr> <tr><td>options.breadthFirst</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>是否使用广度优先搜索算法，默认使用深度优先搜索算法。</td></tr> <tr><td>options.deep</td> <td>boolean</td> <td style="text-align:center;"></td> <td><code>false</code></td> <td>是否递归获取所有子节点/边，为 <code>true</code> 时将同时返回所有子孙节点/边的前序节点。</td></tr> <tr><td>options.distance</td> <td>number | number[] | ((distance: number) =&gt; boolean)</td> <td style="text-align:center;"></td> <td>-</td> <td>距获取指定距离的前序节点，节点和节点之间相隔的边的数量为 <code>1</code> 个距离单位。</td></tr></tbody></table> <h4 id="getsuccessors"><a href="#getsuccessors" class="header-anchor">#</a> getSuccessors(...)</h4> <div class="language-sign extra-class"><pre class="language-text"><code>getSuccessors(cell: Cell, options?: GetPredecessorsOptions): Cell[]
</code></pre></div><p>获取所有后续节点，即从指定节点开始连接到叶子节点的节点。其中 <code>options</code> 选项与 <a href="#getpredecessors"><code>getPredecessors(...)</code></a> 方法的选项一致。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/document/vue3-base.html" class="prev">
        Vue3 基础知识
      </a></span> <span class="next"><a href="/document/Promise/">
        Promise对象
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4e651e34.js" defer></script><script src="/assets/js/2.9d5427ba.js" defer></script><script src="/assets/js/43.b6aa7346.js" defer></script>
  </body>
</html>
